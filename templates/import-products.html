<ion-view view-title="Importar Productos" ng-init="initImportProducts()">
    
    <ion-content  overflow-scroll="true" style="background-color: #F1F1F1">
        <ion-refresher pulling-text="Pull to refresh..." on-refresh="initImportProducts()">
        </ion-refresher>
        <div style="width:100%">
            <div style="float:left;" class="card">
                <button class="button button-dark" ng-click="selectCategory();" style="margin:auto">Categorías</button>
                <a ng-if="addon_puntos==1" class="button button-dark" target="_self" href="https://drive.google.com/uc?export=download&id=1JrQzAUHXhcanlIICjbtSNWxXNzRUU2Um"
                    download="Opciones.xls" ng-click="downloadExample();" style="margin:auto">Plantilla Excel</a>
                <a ng-if="addon_puntos==0" class="button button-dark" target="_self" href="https://drive.google.com/uc?export=download&id=1I1mFaYqipNc0ZCDrXBiP6SergiTBEEhk"
                    download="Opciones.xls" ng-click="downloadExample();" style="margin:auto">Plantilla Excel</a>
                <label ng-show="selectedCategory.name" ng-disabled="excel"for="excelFile" class="button button-dark">
                        <input type="file" id="excelFile" style="display: none;" xlsx-model="excel" multiple>
                        Cargar Excel
                </label>
                <a ng-show="excel" ng-disabled="uploaded==1" class="button button-dark" target="_self" ng-click="postData();" style="margin:auto">Subir Carga</a>
                <a ng-show="selectedCategory.name" class="button button-dark" ng-click="reload()" style="margin:auto">Limpiar</a>
                <a ng-show="uploaded == 1" class="button button-dark" ng-click="reload()" style="margin:auto">Nueva Carga</a>
            </div>
        </div>
        <br/>
        <div ng-if="!selectedCategory.name">
            <p style="width: 100%;text-align: center;font-weight: bold">Seleccione una categoría</p>
        </div>
        <div ng-if="selectedCategory.name && excel == null">
            <p style="width: 100%;text-align: center;font-weight: bold">Cargue el archivo de Excel para la categoría {{selectedCategory.name}}</p>
        </div>
        <div ng-if="excel && uploaded == 0">
            <p style="width: 100%;text-align: center;font-weight: bold">Puede verificar los datos y luego subir la carga</p>
        </div>
        <div ng-if="uploaded == 1">
            <p style="width: 100%;text-align: center;font-weight: bold">Para cargar otro excel haz clic en Nueva Carga</p>
        </div>
        <br />
        



        <div ng-if="excel" style="width:100%">
            <div ng-repeat="x in excel">
                <div ng-repeat="y in x">
                    <div class="card" style="width: 90%;margin-left: 5%;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);" >
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                Vista Preliminar
                            </div>
                            <div class="panel-body">
                                <div class="dataTable_wrapper">
                                    <table datatable="ng" class="table table-striped table-bordered table-hover" id="mainMenu">
                                        <thead>
                                            <tr>
                                                <th>Categoria</th>
                                                <th>Nombre</th>
                                                <th>Descripcion</th>
                                                <th>Precio</th>
                                                <th>Precio Descripcion</th>
                                                <th ng-if="addon_puntos==1">Puntos</th>
                                            </tr>
                                        </thead>
                                        <tbody>


                                            <tr ng-repeat="z in y track by $index" ng-init="populateProduct(z)">
                                                <td>{{selectedCategory.name}}</td>
                                                <td>{{z.Producto}}</td>
                                                <td>{{z.Descripcion}}</td>
                                                <td>{{z.Precio}}</td>
                                                <td>{{z.PrecioDescriptivo}}</td>
                                                <td ng-if="addon_puntos==1">{{z.Puntos}}</td>
                                            </tr>


                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </ion-content>
</ion-view>